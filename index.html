<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒ•ã‚§ãƒ–ãƒ©ãƒªãƒ¼Så‰å“¨æˆ¦ ç«¶é¦¬æ–°è</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;600;700;900&family=Noto+Sans+JP:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --ink: #1a1008;
    --aged: #f5ede0;
    --cream: #fdf8f0;
    --accent: #b5281a;
    --gold: #c8922a;
    --dark: #2c1a0a;
    --border: #8b6b3a;
    --mid: #6b4c2a;
    --win: #a51313;
    --lose: #1a3a8b;
    --shadow: rgba(60,30,10,0.18);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: #d9c9a8;
    background-image:
      repeating-linear-gradient(0deg, transparent, transparent 28px, rgba(120,80,30,0.07) 28px, rgba(120,80,30,0.07) 29px),
      repeating-linear-gradient(90deg, transparent, transparent 28px, rgba(120,80,30,0.05) 28px, rgba(120,80,30,0.05) 29px);
    font-family: 'Noto Serif JP', serif;
    color: var(--ink);
    min-height: 100vh;
    padding: 24px 12px 40px;
  }

  .newspaper {
    max-width: 1080px;
    margin: 0 auto;
    background: var(--cream);
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='400' height='400' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    border: 2px solid var(--border);
    box-shadow: 6px 6px 32px var(--shadow), 0 0 0 6px #c8a96a33;
    position: relative;
  }

  /* Header */
  .header {
    border-bottom: 4px double var(--border);
    padding: 18px 28px 14px;
    position: relative;
    background: linear-gradient(to bottom, #f0e4ca, var(--cream));
  }

  .header-top {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 16px;
  }

  .paper-name {
    font-size: 3.2rem;
    font-weight: 900;
    letter-spacing: 0.18em;
    color: var(--accent);
    text-shadow: 2px 2px 0 #7a100a44;
    line-height: 1;
  }

  .paper-sub {
    font-size: 0.75rem;
    font-family: 'Noto Sans JP', sans-serif;
    color: var(--mid);
    letter-spacing: 0.12em;
    margin-top: 4px;
  }

  .header-meta {
    text-align: right;
    font-size: 0.78rem;
    font-family: 'Noto Sans JP', sans-serif;
    color: var(--mid);
    line-height: 1.7;
  }

  .race-title-bar {
    margin-top: 12px;
    background: var(--dark);
    color: #f5e6c2;
    text-align: center;
    padding: 7px 0 6px;
    letter-spacing: 0.35em;
    font-size: 1.05rem;
    font-weight: 700;
    border-left: 6px solid var(--gold);
    border-right: 6px solid var(--gold);
  }

  /* Content */
  .content {
    padding: 20px 28px 28px;
  }

  .section-head {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 24px 0 14px;
  }

  .section-head::before, .section-head::after {
    content: '';
    flex: 1;
    height: 2px;
    background: linear-gradient(to right, var(--gold), transparent);
  }
  .section-head::after {
    background: linear-gradient(to left, var(--gold), transparent);
  }

  .section-head span {
    font-size: 0.8rem;
    font-family: 'Noto Sans JP', sans-serif;
    font-weight: 700;
    letter-spacing: 0.22em;
    color: var(--gold);
    white-space: nowrap;
  }

  /* Winner cards grid */
  .winners-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 16px;
  }

  .card {
    border: 1.5px solid var(--border);
    background: linear-gradient(135deg, #fffbf3 80%, #f5e8cf);
    position: relative;
    overflow: hidden;
    transition: transform 0.18s, box-shadow 0.18s;
    cursor: default;
  }

  .card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(to right, var(--accent), var(--gold));
  }

  .card:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 24px var(--shadow);
  }

  .card-header {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 14px 8px;
    border-bottom: 1px dashed var(--border);
    background: rgba(184,140,60,0.08);
  }

  .day-badge {
    background: var(--accent);
    color: #fff;
    font-size: 0.65rem;
    font-family: 'Noto Sans JP', sans-serif;
    font-weight: 700;
    padding: 2px 7px;
    letter-spacing: 0.08em;
    white-space: nowrap;
  }

  .winner-rank {
    font-size: 1.4rem;
    font-weight: 900;
    color: var(--gold);
    text-shadow: 1px 1px 0 #7a4a0055;
    line-height: 1;
    flex-shrink: 0;
  }

  .winner-name {
    font-size: 1.1rem;
    font-weight: 700;
    letter-spacing: 0.05em;
    line-height: 1.2;
    flex: 1;
  }

  .card-body {
    padding: 10px 14px 12px;
    display: flex;
    gap: 14px;
    font-family: 'Noto Sans JP', sans-serif;
    font-size: 0.72rem;
  }

  .info-col {
    flex: 0 0 auto;
    display: flex;
    flex-direction: column;
    gap: 4px;
    color: var(--mid);
    min-width: 130px;
  }

  .info-row {
    display: flex;
    gap: 6px;
    align-items: center;
  }

  .info-label {
    background: var(--dark);
    color: #f0ddb8;
    padding: 1px 5px;
    font-size: 0.62rem;
    font-weight: 700;
    letter-spacing: 0.04em;
    white-space: nowrap;
    flex-shrink: 0;
  }

  .info-val {
    color: var(--ink);
    font-weight: 700;
    font-size: 0.75rem;
  }

  .style-tag {
    display: inline-block;
    background: var(--gold);
    color: #fff;
    font-size: 0.6rem;
    font-weight: 700;
    padding: 1px 6px;
    letter-spacing: 0.05em;
  }

  /* Battle table */
  .battle-col {
    flex: 1;
    border-left: 1px dashed var(--border);
    padding-left: 10px;
  }

  .battle-title {
    font-size: 0.62rem;
    font-weight: 700;
    color: var(--mid);
    letter-spacing: 0.1em;
    margin-bottom: 5px;
    border-bottom: 1px solid #d4b880;
    padding-bottom: 3px;
  }

  .battle-entry {
    display: flex;
    align-items: center;
    gap: 5px;
    margin-bottom: 3px;
    font-size: 0.67rem;
    line-height: 1.3;
  }

  .br {
    font-size: 0.55rem;
    font-weight: 900;
    padding: 1px 4px;
    border-radius: 2px;
    flex-shrink: 0;
  }

  .br-win {
    background: var(--win);
    color: #fff;
  }

  .br-lose {
    background: var(--lose);
    color: #fff;
  }

  .br-day {
    color: var(--mid);
    font-size: 0.6rem;
    flex-shrink: 0;
  }

  .battle-none {
    color: #aaa;
    font-size: 0.65rem;
    font-style: italic;
  }

  /* Skills section */
  .skills-section {
    padding: 8px 14px 12px;
    border-top: 1px dashed var(--border);
    font-family: 'Noto Sans JP', sans-serif;
  }

  .skills-title {
    font-size: 0.6rem;
    font-weight: 700;
    color: var(--mid);
    letter-spacing: 0.1em;
    margin-bottom: 6px;
  }

  .skills-wrap {
    display: flex;
    flex-wrap: wrap;
    gap: 3px;
  }

  .skill-tag {
    background: #e8dfc0;
    border: 1px solid #c4a86a;
    color: var(--dark);
    font-size: 0.58rem;
    padding: 1px 6px;
    border-radius: 2px;
    font-weight: 700;
    letter-spacing: 0.02em;
  }

  .skill-tag.s3 { border-color: var(--gold); background: #fff8e0; }
  .skill-tag.s4 { border-color: var(--accent); background: #fff0ee; color: var(--accent); }

  .time-badge {
    font-size: 0.68rem;
    font-weight: 700;
    font-family: 'Noto Sans JP', sans-serif;
    color: var(--ink);
  }

  /* Full head to head table */
  .h2h-section {
    margin-top: 28px;
  }

  .h2h-table-wrap {
    overflow-x: auto;
  }

  .h2h-table {
    width: 100%;
    border-collapse: collapse;
    font-family: 'Noto Sans JP', sans-serif;
    font-size: 0.72rem;
  }

  .h2h-table th {
    background: var(--dark);
    color: #f0ddb8;
    padding: 6px 10px;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-align: center;
    white-space: nowrap;
    border: 1px solid var(--border);
    font-size: 0.65rem;
  }

  .h2h-table th.name-col {
    background: #3d2208;
    text-align: left;
    min-width: 110px;
  }

  .h2h-table td {
    border: 1px solid #d4b880;
    padding: 5px 8px;
    text-align: center;
    vertical-align: middle;
  }

  .h2h-table tr:nth-child(even) td {
    background: rgba(200,162,80,0.06);
  }

  .h2h-table tr:hover td {
    background: rgba(200,162,80,0.14);
  }

  .h2h-table td.name-col {
    text-align: left;
    font-weight: 700;
    font-size: 0.78rem;
    color: var(--dark);
    background: rgba(200,162,80,0.06);
    white-space: nowrap;
  }

  .cell-win {
    background: #ffeaea !important;
    color: var(--win);
    font-weight: 700;
    font-size: 0.65rem;
  }

  .cell-lose {
    background: #eaefff !important;
    color: var(--lose);
    font-weight: 700;
    font-size: 0.65rem;
  }

  .cell-self {
    background: #2c1a0a !important;
  }

  .cell-empty {
    color: #ccc;
    font-size: 0.6rem;
  }

  /* Footer */
  .footer {
    border-top: 3px double var(--border);
    padding: 10px 28px;
    font-family: 'Noto Sans JP', sans-serif;
    font-size: 0.65rem;
    color: var(--mid);
    display: flex;
    justify-content: space-between;
    background: linear-gradient(to top, #ede0c4, var(--cream));
    letter-spacing: 0.06em;
  }

  @media (max-width: 600px) {
    .paper-name { font-size: 2rem; }
    .content { padding: 14px 14px 20px; }
    .winners-grid { grid-template-columns: 1fr; }
    .card-body { flex-direction: column; }
    .battle-col { border-left: none; padding-left: 0; border-top: 1px dashed var(--border); padding-top: 8px; }
  }
</style>
</head>
<body>
<div class="newspaper">

  <!-- HEADER -->
  <div class="header">
    <div class="header-top">
      <div>
        <div class="paper-name">ç«¶ é¦¬ æ–° è</div>
        <div class="paper-sub">KEIBA SHINBUN ï¼ å…¨å›½ãƒ€ãƒ¼ãƒˆç«¶èµ°é€Ÿå ±</div>
      </div>
      <div class="header-meta">
        è·é›¢ï¼šãƒ€ãƒ¼ãƒˆ 1600m<br>
        å…¨15æ—¥é–“ãƒ¬ãƒ¼ã‚¹<br>
        ãƒ•ã‚§ãƒ–ãƒ©ãƒªãƒ¼Så‰å“¨æˆ¦
      </div>
    </div>
    <div class="race-title-bar">â—† ãƒ•ã‚§ãƒ–ãƒ©ãƒªãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¯ã‚¹ å‰å“¨æˆ¦ â—† æ­´ä»£å‹é¦¬é€Ÿå ± â—†</div>
  </div>

  <!-- CONTENT -->
  <div class="content">

    <div class="section-head"><span>â–¼ å„æ—¥ 1ç€é¦¬ ã‚«ãƒ¼ãƒ‰</span></div>

    <div class="winners-grid" id="winners-grid"></div>

    <div class="section-head h2h-section"><span>â–¼ å‹é¦¬ å¯¾æˆ¦ãƒãƒˆãƒªãƒƒã‚¯ã‚¹è¡¨</span></div>
    <p style="font-family:'Noto Sans JP',sans-serif;font-size:0.7rem;color:var(--mid);margin-bottom:10px;">
      <span style="background:#ffeaea;color:#a51313;padding:1px 6px;font-weight:700;border:1px solid #c88;">â—è² </span>
      åŒå£«ãŒåŒä¸€ãƒ¬ãƒ¼ã‚¹ã§å¯¾æˆ¦ã—ãŸçµæœã‚’è¡¨ç¤ºã€‚ç¸¦è»¸ã®é¦¬ã‹ã‚‰è¦‹ãŸçµæœã§ã™ã€‚
      <span style="background:#eaefff;color:#1a3a8b;padding:1px 6px;font-weight:700;border:1px solid #8ac;margin-left:6px;">â—å‹</span>ã¯ç›¸æ‰‹ã‚ˆã‚Šä¸Šä½ç€é †ã€‚
    </p>
    <div class="h2h-table-wrap">
      <table class="h2h-table" id="h2h-table"></table>
    </div>

  </div>

  <div class="footer">
    <span>â€» å°å‡¡ä¾‹ï¼šAKâ— GOâ— VCâ— ãƒ¢ãƒ³ã‚ºâ— ãªã©å„äºˆæƒ³å®¶ã®æœ¬å‘½å°</span>
    <span>é“ä¸­è¡¨è¨˜ï¼šä¸­é–“é€šéé †ä½-æœ€çµ‚ç€é †</span>
  </div>
</div>

<script>
// ========== ãƒ‡ãƒ¼ã‚¿å®šç¾© ==========
const winners = [
  {
    day: 'ä¸€æ—¥ç›®',
    name: 'ã‚¹ãƒˆãƒ©ãƒ€ãƒ‹ã‚¨ãƒ«',
    popularity: 13,
    frame: 4,
    time: '1:27',
    style: 'è¿½ã„è¾¼ã¿',
    position: '?â†’13',
    skills: ['æœ€çµ‚ç›´ç·šé€Ÿåº¦'],
    marks: [],
  },
  {
    day: 'äºŒæ—¥ç›®',
    name: 'ã‚¨ãƒãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„',
    popularity: 15,
    frame: 2,
    time: '1:28',
    style: 'è¿½ã„è¾¼ã¿',
    position: '?â†’15',
    skills: ['æœ€çµ‚ç›´ç·šæŒç¶š', 'æœ€çµ‚ç›´ç·šé€Ÿåº¦'],
    marks: [],
  },
  {
    day: 'ä¸‰æ—¥ç›®',
    name: 'ãƒ†ãƒ³ãƒ ãƒ³ã‚¯',
    popularity: 1,
    frame: 2,
    time: '1:28',
    style: '?',
    position: '?â†’6',
    skills: ['å¯¾æŠ—æ„è­˜Lv4', 'ãƒ©ã‚¹ãƒˆã‚¹ãƒ‘ãƒ¼ãƒˆLv3', 'æœ€çµ‚ç›´ç·šé€Ÿåº¦'],
    marks: ['VCâ—', 'GOâ—', 'ãƒ¢ãƒ³ã‚ºâ—'],
  },
  {
    day: 'å››æ—¥ç›®',
    name: 'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆãƒ‰ãƒ¼ãƒ ',
    popularity: 3,
    frame: 6,
    time: '1:27',
    style: 'è¿½ã„è¾¼ã¿',
    position: '12â†’4',
    skills: ['ä¸­ç›¤', 'æœ€çµ‚ç›´ç·šæŒç¶š', 'æœ€çµ‚ç›´ç·šé€Ÿåº¦'],
    marks: ['AKâ—'],
  },
  {
    day: 'äº”æ—¥ç›®',
    name: 'ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚¢ãƒ”ãƒ¼ãƒ©',
    popularity: 13,
    frame: 16,
    time: '1:28',
    style: 'è¿½ã„è¾¼ã¿',
    position: '?â†’14',
    skills: ['æœ€çµ‚ç›´ç·šé€Ÿåº¦', 'æœ€çµ‚ç›´ç·šæŒç¶š'],
    marks: [],
  },
  {
    day: 'å…­æ—¥ç›®',
    name: 'ãƒ¤ãƒ³ã‚°',
    popularity: 2,
    frame: 5,
    time: '1:29',
    style: 'è¿½ã„è¾¼ã¿',
    position: '8â†’6',
    skills: ['æœ€çµ‚ç›´ç·šé€Ÿåº¦'],
    marks: [],
  },
  {
    day: 'ä¸ƒæ—¥ç›®',
    name: 'ã‚µãƒ€ãƒã‚­ãƒƒã‚­ãƒ³ã‚°',
    popularity: 9,
    frame: 2,
    time: '1:26',
    style: 'å…ˆè¡Œ',
    position: '2â†’2',
    skills: ['å¥½ä½ç¢ºä¿Lv3(J)', 'å…ˆæ‰‹å¿…å‹Lv4', 'ç‹è€…ã®æ­©ã¿Lv1', 'ä¸–ç•Œã‚’åˆ¶ã—ãŸæ—¥æœ¬ä»£è¡¨Lv1', 'ç›´ç·šä¸€æ°—Lv1ã€å›ºæœ‰ã€‘', 'æ¸¾èº«ã®æœ«è„šLv3'],
    marks: [],
  },
  {
    day: 'å…«æ—¥ç›®',
    name: 'ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ›ãƒ¼ã‚¹',
    popularity: 5,
    frame: 3,
    time: '1:37',
    style: 'é€ƒã’',
    position: '2â†’1',
    skills: ['ãƒšãƒ¼ã‚¹ã‚¢ãƒƒãƒ—Lv4', 'ç‹è€…ã®æ­©ã¿Lv1', 'ãƒ¯ãƒ³ãƒ€ãƒ¼ãƒ›ãƒ¼ã‚¹Lv1', 'æœ€çµ‚ç›´ç·šæŒç¶šLv3', 'æ¸¾èº«ã®æœ«è„šLv3', 'å‹åˆ©ã®å’†å“®Lv1'],
    marks: [],
  },
  {
    day: 'ä¹æ—¥ç›®',
    name: 'ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ•ã‚£ã‚º',
    popularity: 3,
    frame: 2,
    time: '1:27',
    style: 'é€ƒã’',
    position: '1â†’1',
    skills: ['è¿½ã„ä¸Šã’Lv3', 'æŠœã‘å‡ºã—Lv3', 'æœ€çµ‚ç›´ç·šæŒç¶šLv3', 'æ¸¾èº«ã®æœ«è„šLv3', 'æœ€çµ‚ç›´ç·šé€Ÿåº¦Lv4'],
    marks: ['AKâ—'],
  },
  {
    day: 'åæ—¥ç›®',
    name: 'ãƒ€ãƒ©ãƒ³ãƒ‡ãƒ¥ãƒ«',
    popularity: 11,
    frame: 13,
    time: '1:28',
    style: 'è¿½ã„è¾¼ã¿',
    position: '?â†’10',
    skills: ['å…ˆé ­ç¢ºä¿Lv3(J)', 'æœ€çµ‚ç›´ç·šé€Ÿåº¦'],
    marks: [],
  },
  {
    day: 'åä¸€æ—¥ç›®',
    name: 'ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒãƒ¼ãƒˆ',
    popularity: 2,
    frame: 2,
    time: '1:27',
    style: 'é€ƒã’',
    position: '1â†’1',
    skills: ['å…ˆé ­ç¢ºä¿Lv3(J)', 'ç‹è€…ã®æ­©ã¿Lv1', 'ãƒ¯ãƒ³ãƒ€ãƒ¼ãƒ›ãƒ¼ã‚¹Lv1', 'è¿½ã„ä¸Šã’Lv3', 'æŠœã‘å‡ºã—Lv3', 'å‹åˆ©ã®å’†å“®Lv1', 'æ¸¾èº«ã®æœ«è„šLv3'],
    marks: ['AKâ—'],
  },
  {
    day: 'åäºŒæ—¥ç›®',
    name: 'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆã‚¯ãƒ©ã‚¤',
    popularity: 1,
    frame: 14,
    time: '1:27',
    style: 'å…ˆè¡Œ',
    position: '3â†’1',
    skills: ['10ãƒãƒ­ãƒ³ã®ãƒšãƒ¼ã‚¹ã‚¢ãƒƒãƒ—Lv?', 'ç‹è€…ã®æ­©ã¿Lv1', 'æŠœã‘å‡ºã—Lv3', 'æœ€çµ‚ç›´ç·šæŒç¶šLv3', 'æœ€çµ‚ç›´ç·šé€Ÿåº¦ã€åé¦¬ã€‘Lv1', 'æœ€çµ‚ç›´ç·šé€Ÿåº¦Lv4'],
    marks: ['AKâ—'],
  },
  {
    day: 'åä¸‰æ—¥ç›®',
    name: 'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆã‚ªãƒ¼ãƒ´',
    popularity: 4,
    frame: 3,
    time: '1:27',
    style: 'é€ƒã’',
    position: '1â†’1',
    skills: ['å…ˆé ­ç¢ºä¿Lv3(J)', 'å…ˆæ‰‹å¿…å‹Lv4', 'ãƒ¯ãƒ³ãƒ€ãƒ¼ãƒ›ãƒ¼ã‚¹Lv1', 'æ‰èƒ½ã¨åŠªåŠ›ã®çµå®ŸLv1', 'å‹åˆ©ã®å’†å“®Lv1', 'æ¸¾èº«ã®æœ«è„šLv3'],
    marks: [],
  },
  {
    day: 'åå››æ—¥ç›®',
    name: 'ã‚ªãƒ‹ãƒ¨ãƒ¡ãƒã‚¯ã‚¿ãƒ³',
    popularity: 2,
    frame: 13,
    time: '1:28',
    style: 'å…ˆè¡Œ',
    position: '6â†’5',
    skills: ['è±ªè„šä¸€é–ƒãƒ»ãƒ€ãƒ¼ãƒˆLv3', 'æœ€çµ‚ç›´ç·šé€Ÿåº¦'],
    marks: [],
  },
  {
    day: 'åäº”æ—¥ç›®',
    name: 'ã‚¹ãƒˆãƒ©ãƒ­ã¹ãƒ‹ã‚¢',
    popularity: 11,
    frame: 12,
    time: '1:28',
    style: 'è¿½ã„è¾¼ã¿',
    position: '15â†’14',
    skills: ['æœ€çµ‚ç›´ç·šé€Ÿåº¦', 'æœ€çµ‚ç›´ç·šæŒç¶š'],
    marks: [],
  },
];

// ========== å¯¾æˆ¦å±¥æ­´ï¼ˆåŒä¸€ãƒ¬ãƒ¼ã‚¹å‡ºèµ°ï¼‰ ==========
// å„ãƒ¬ãƒ¼ã‚¹ã®å…¨é¦¬ãƒ‡ãƒ¼ã‚¿ï¼ˆç€é †å«ã‚€ï¼‰
// format: { day, dayNum, horses: [{name, rank}] }
const races = [
  { day: 'ä¸€æ—¥ç›®', horses: [{name:'ã‚¹ãƒˆãƒ©ãƒ€ãƒ‹ã‚¨ãƒ«',rank:1},{name:'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆãƒ«ãƒ¼ã‚¹',rank:2},{name:'ãƒ¬ã‚ªãƒ³ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰',rank:3},{name:'ã‚¢ãƒ‰ãƒã‚¤ãƒ¤ãƒ™ã‚¬ã‚µãƒ³',rank:4},{name:'ãƒŠã‚¤ãƒˆã‚ªãƒ–ã‚¿ãƒãƒã‚®',rank:5}] },
  { day: 'äºŒæ—¥ç›®', horses: [{name:'ã‚¨ãƒãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„',rank:1},{name:'ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¨ãƒªãƒ¼ãƒˆ',rank:2},{name:'ãƒˆãƒ¬ãƒ³ãƒ‰',rank:3},{name:'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆãƒ¯ãƒ³ãƒ€',rank:4},{name:'ãƒ‡ã‚£ãƒ¼ãƒ—ã‚ªã‚¸ãƒ§ã‚¦',rank:5}] },
  { day: 'ä¸‰æ—¥ç›®', horses: [{name:'ãƒ†ãƒ³ãƒ ãƒ³ã‚¯',rank:1},{name:'ãƒ¡ã‚¬ã‚«ãƒ¡ãƒƒã‚¯ã‚¹',rank:2},{name:'ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¨ãƒªãƒ¼ãƒˆ',rank:3},{name:'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆã‚ªãƒ¼ãƒ´',rank:4},{name:'ã‚°ãƒ©ã‚¿ãƒ³ã‚¿ãƒ™ã‚¿ã‚¤',rank:5}] },
  { day: 'å››æ—¥ç›®', horses: [{name:'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆãƒ‰ãƒ¼ãƒ ',rank:1},{name:'ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚¢ãƒ”ãƒ¼ãƒ©',rank:2},{name:'ãƒ¤ãƒ³ã‚°',rank:3},{name:'ã‚»ã‚«ã‚¤ã‚ªã‚¸ãƒ§ãƒ¼',rank:4},{name:'ãƒ˜ã‚½ãƒ»ãƒ”',rank:5}] },
  { day: 'äº”æ—¥ç›®', horses: [{name:'ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚¢ãƒ”ãƒ¼ãƒ©',rank:1},{name:'ãƒã‚¤ãƒ‘ãƒ¼',rank:2},{name:'ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒãƒ¼ãƒˆ',rank:3},{name:'ãƒ¬ãƒ‡ã‚£ã‚¹ã‚¤ãƒ¼ãƒˆ',rank:4},{name:'ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ³ã‚³ãƒ«ãƒ‰',rank:5}] },
  { day: 'å…­æ—¥ç›®', horses: [{name:'ãƒ¤ãƒ³ã‚°',rank:1},{name:'ãƒˆãƒ­ãƒƒãƒˆã‚µãƒ³ãƒ€ãƒ¼ã‚¹',rank:2},{name:'ãƒã‚¤ãƒ‘ãƒ¼',rank:3},{name:'ã‚­ã‚¿ã‚µãƒ³ã‚¯ã‚¤ãƒ¼ãƒ³',rank:4},{name:'ãƒŠãƒ³ãƒˆã‚«ã‚·ãƒ¨ã‚¦ã‚«',rank:5}] },
  { day: 'ä¸ƒæ—¥ç›®', horses: [{name:'ã‚µãƒ€ãƒã‚­ãƒƒã‚­ãƒ³ã‚°',rank:1},{name:'ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒãƒ¼ãƒˆ',rank:2},{name:'ã‚¿ã‚¸ãƒã‚®ãƒ¥ã‚¦',rank:3},{name:'ã‚¹ã‚³ã‚·ã‚¬ãƒ³ãƒãƒ«',rank:4},{name:'ãƒŠãƒ³ã‚·ãƒ¼ãƒã‚§ãƒ‹ãƒ¼',rank:5}] },
  { day: 'å…«æ—¥ç›®', horses: [{name:'ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ›ãƒ¼ã‚¹',rank:1},{name:'ã‚ªãƒ‹ãƒ¨ãƒ¡ãƒã‚¯ã‚¿ãƒ³',rank:2},{name:'ãƒã‚¤ãƒ‘ãƒ¼',rank:3},{name:'ãƒ¬ãƒ‡ã‚£ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆ',rank:4},{name:'ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¨ãƒªãƒ¼ãƒˆ',rank:5}] },
  { day: 'ä¹æ—¥ç›®', horses: [{name:'ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ•ã‚£ã‚º',rank:1},{name:'ãƒ‡ã‚£ãƒ¼ãƒ—ãƒˆãƒ«ãƒãƒ¼ãƒ‰',rank:2},{name:'ã‚ªãƒ‹ãƒ¨ãƒ¡ãƒã‚¯ã‚¿ãƒ³',rank:3},{name:'ã‚¹ã‚³ã‚·ã‚¬ãƒ³ãƒãƒ«',rank:4},{name:'ãƒ¬ãƒ‡ã‚£ã‚­ãƒ¼ãƒ«',rank:5}] },
  { day: 'åæ—¥ç›®', horses: [{name:'ãƒ€ãƒ©ãƒ³ãƒ‡ãƒ¥ãƒ«',rank:1},{name:'ã‚ªãƒ‹ãƒ¨ãƒ¡ãƒã‚¯ã‚¿ãƒ³',rank:2},{name:'ãƒ–ãƒ«ãƒ¼ã‚¤ãƒ³ãƒ‘ãƒ«ã‚¹',rank:3},{name:'ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒãƒ¼ãƒˆ',rank:4},{name:'ã‚·ãƒ«ãƒ•ã‚£ãƒ¼ãƒ‰',rank:5}] },
  { day: 'åä¸€æ—¥ç›®', horses: [{name:'ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒãƒ¼ãƒˆ',rank:1},{name:'ãƒŠã‚¤ãƒˆã‚ªãƒ–ã‚¿ãƒãƒã‚®',rank:2},{name:'ãƒãƒ¼ã‚¨ãƒãƒ¼ã‚ªãƒ¼ãƒ«ãƒ‰',rank:3},{name:'ã‚¹ãƒªãƒ¼ã‚¢ãƒƒãƒ—ãƒ¤ãƒ³ã‚°',rank:4},{name:'ãƒãƒ¼ãƒ•ã‚£ãƒ¼',rank:5}] },
  { day: 'åäºŒæ—¥ç›®', horses: [{name:'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆã‚¯ãƒ©ã‚¤',rank:1},{name:'ãƒ¬ãƒ‡ã‚£ã‚­ãƒ¼ãƒ«',rank:2},{name:'ã‚ªãƒ‹ãƒ¨ãƒ¡ãƒã‚¯ã‚¿ãƒ³',rank:3},{name:'ãƒ‡ã‚£ãƒ¼ãƒ—ã‚¨ãƒªãƒ¼ãƒˆ',rank:4},{name:'ãƒˆãƒ­ãƒƒãƒˆã‚µãƒ³ãƒ€ãƒ¼ã‚¹',rank:5}] },
  { day: 'åä¸‰æ—¥ç›®', horses: [{name:'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆã‚ªãƒ¼ãƒ´',rank:1},{name:'ã‚ªãƒ‹ãƒ¨ãƒ¡ãƒã‚¯ã‚¿ãƒ³',rank:2},{name:'ãƒ©ã‚¯ã‚»ã‚¹ãƒ–ãƒ­ãƒƒã‚±ãƒ³',rank:3},{name:'ãƒ‹ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹',rank:4},{name:'ã‚µãƒ³ãƒ‡ãƒ¼ãƒ™ã‚¬ã‚¯ãƒ³',rank:5}] },
  { day: 'åå››æ—¥ç›®', horses: [{name:'ã‚ªãƒ‹ãƒ¨ãƒ¡ãƒã‚¯ã‚¿ãƒ³',rank:1},{name:'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆãƒ«ãƒ¼ã‚¹',rank:2},{name:'ã‚¹ãƒ†ã‚´ãƒã‚¨ãƒãƒ¤ãƒ³',rank:3},{name:'ãƒã‚¤ãƒ‘ãƒ¼',rank:4},{name:'ãƒãƒªãƒã‚±ãƒ„',rank:5}] },
  { day: 'åäº”æ—¥ç›®', horses: [{name:'ã‚¹ãƒˆãƒ©ãƒ­ã¹ãƒ‹ã‚¢',rank:1},{name:'ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆãƒ«ãƒ¼ã‚¹',rank:2},{name:'ãƒ¬ãƒ‡ã‚£ã‚­ãƒ¼ãƒ«',rank:3},{name:'ãƒ’ã‚²ã‚¸ãƒ¼ã‚¿ãƒ¼',rank:4},{name:'ã‚¹ãºãƒ–ã‚¨ãƒŠãƒ¤ãƒ³ã‚°',rank:5}] },
];

const winnerNames = winners.map(w => w.name);

// Build battle map: battles[A][B] = [{day, aRank, bRank}]
const battles = {};
winnerNames.forEach(n => battles[n] = {});

races.forEach(race => {
  const raceWinners = race.horses.filter(h => winnerNames.includes(h.name));
  for (let i = 0; i < raceWinners.length; i++) {
    for (let j = 0; j < raceWinners.length; j++) {
      if (i === j) continue;
      const a = raceWinners[i];
      const b = raceWinners[j];
      if (!battles[a.name][b.name]) battles[a.name][b.name] = [];
      battles[a.name][b.name].push({ day: race.day, aRank: a.rank, bRank: b.rank });
    }
  }
});

// ========== ã‚«ãƒ¼ãƒ‰ç”Ÿæˆ ==========
function skillClass(s) {
  if (s.includes('Lv4')) return 's4';
  if (s.includes('Lv3') || s.includes('Lv1')) return 's3';
  return '';
}

function getBattleEntries(winnerName, limit) {
  const entries = [];
  for (const opponent of winnerNames) {
    if (opponent === winnerName) continue;
    const records = battles[winnerName][opponent];
    if (records && records.length > 0) {
      records.forEach(r => {
        const won = r.aRank < r.bRank;
        entries.push({ opponent, day: r.day, won, aRank: r.aRank, bRank: r.bRank });
      });
    }
  }
  if (limit) return entries.slice(0, limit);
  return entries;
}

const grid = document.getElementById('winners-grid');
winners.forEach((w, idx) => {
  const battleEntries = getBattleEntries(w.name, 5);
  const battleHTML = battleEntries.length === 0
    ? '<div class="battle-none">å¯¾æˆ¦ãªã—</div>'
    : battleEntries.map(e => {
        const cls = e.won ? 'br-win' : 'br-lose';
        const label = e.won ? 'å‹' : 'è² ';
        return `<div class="battle-entry"><span class="br ${cls}">â—${label}</span><span class="br-day">${e.day}</span><span>${e.opponent}ï¼ˆ${e.bRank}ç€ï¼‰</span></div>`;
      }).join('');

  const skillsHTML = w.skills.map(s =>
    `<span class="skill-tag ${skillClass(s)}">${s}</span>`
  ).join('');

  const marksHTML = w.marks.length > 0
    ? `<span style="font-family:'Noto Sans JP',sans-serif;font-size:0.62rem;color:#a51313;font-weight:700;margin-left:6px;">${w.marks.join(' ')}</span>` : '';

  const popColor = w.popularity >= 10 ? '#888' : w.popularity <= 3 ? '#a51313' : '#2c5f2e';

  grid.innerHTML += `
    <div class="card">
      <div class="card-header">
        <span class="day-badge">${w.day}</span>
        <div>
          <div style="display:flex;align-items:center;gap:6px;">
            <span class="winner-rank">ğŸ†</span>
            <span class="winner-name">${w.name}</span>
            ${marksHTML}
          </div>
        </div>
      </div>
      <div class="card-body">
        <div class="info-col">
          <div class="info-row"><span class="info-label">æ </span><span class="info-val">${w.frame}æ </span></div>
          <div class="info-row"><span class="info-label">äººæ°—</span><span class="info-val" style="color:${popColor}">${w.popularity}ç•ªäººæ°—</span></div>
          <div class="info-row"><span class="info-label">T</span><span class="time-badge">${w.time}</span></div>
          <div class="info-row"><span class="info-label">é“ä¸­</span><span class="info-val">${w.position}</span></div>
          <div class="info-row"><span class="info-label">è„šè³ª</span><span class="style-tag">${w.style}</span></div>
        </div>
        <div class="battle-col">
          <div class="battle-title">âš” å‹é¦¬åŒå£« å¯¾æˆ¦å±¥æ­´</div>
          ${battleHTML}
        </div>
      </div>
      <div class="skills-section">
        <div class="skills-title">â–¶ ã‚¹ã‚­ãƒ«æ§‹æˆ</div>
        <div class="skills-wrap">${skillsHTML}</div>
      </div>
    </div>
  `;
});

// ========== å¯¾æˆ¦ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ ==========
const table = document.getElementById('h2h-table');
let headerRow = '<tr><th class="name-col">é¦¬å \\ ç›¸æ‰‹</th>';
winnerNames.forEach((n, i) => {
  headerRow += `<th title="${n}">${i + 1}</th>`;
});
headerRow += '</tr>';

let legendRow = '<tr><td class="name-col" style="font-size:0.6rem;color:var(--mid);font-family:\'Noto Sans JP\',sans-serif;">â‘  ã‚¹ãƒˆãƒ©ãƒ€ãƒ‹ã‚¨ãƒ«<br>â‘¡ ã‚¨ãƒãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„<br>â‘¢ ãƒ†ãƒ³ãƒ ãƒ³ã‚¯<br>â‘£ ã‚µãƒãƒ¼ãƒŠã‚¤ãƒˆãƒ‰ãƒ¼ãƒ <br>â‘¤ ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚¢ãƒ”ãƒ¼ãƒ©<br>â‘¥ ãƒ¤ãƒ³ã‚°<br>â‘¦ ã‚µãƒ€ãƒã‚­ãƒƒã‚­ãƒ³ã‚°<br>â‘§ ãƒ´ã‚¡ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ›ãƒ¼ã‚¹</td>';
winnerNames.slice(0, 8).forEach((n) => {
  legendRow += `<td style="font-size:0.58rem;font-family:\'Noto Sans JP\',sans-serif;color:#666;background:#faf6ec;">-</td>`;
});
legendRow += '</tr>';

let bodyRows = '';
winnerNames.forEach((rowName, ri) => {
  let row = `<tr><td class="name-col">${ri + 1}. ${rowName}</td>`;
  winnerNames.forEach((colName, ci) => {
    if (ri === ci) {
      row += `<td class="cell-self"></td>`;
      return;
    }
    const records = battles[rowName][colName];
    if (!records || records.length === 0) {
      row += `<td class="cell-empty">â”€</td>`;
      return;
    }
    const parts = records.map(r => {
      const won = r.aRank < r.bRank;
      return `<span class="${won ? 'br br-win' : 'br br-lose'}" style="font-size:0.55rem;padding:1px 3px;border-radius:1px;font-weight:900;margin:1px;display:inline-block;">${won ? 'å‹' : 'è² '}<br><span style="font-size:0.48rem;font-weight:400;">${r.day.replace('æ—¥ç›®','')}</span></span>`;
    }).join('');
    const allWon = records.every(r => r.aRank < r.bRank);
    const allLost = records.every(r => r.aRank > r.bRank);
    const cls = allWon ? 'cell-win' : allLost ? 'cell-lose' : '';
    row += `<td class="${cls}" style="padding:3px;">${parts}</td>`;
  });
  row += '</tr>';
  bodyRows += row;
});

table.innerHTML = headerRow + bodyRows;

// Add legend below table
const legendDiv = document.createElement('div');
legendDiv.style.cssText = 'font-family:Noto Sans JP,sans-serif;font-size:0.65rem;color:var(--mid);margin-top:10px;display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:2px 16px;';
winnerNames.forEach((n, i) => {
  legendDiv.innerHTML += `<span>â¶${i+1} = ${n}</span>`;
});
document.querySelector('.h2h-table-wrap').after(legendDiv);
</script>
</body>
</html>
